# Пользовательские пути (User Journeys)

Документ описывает сценарии использования платформы менторинга по ролям: какой экран за каким открывается, по каким триггерам, когда и где какие элементы показываются. Используется при проектировании экранов и навигации.

Требования к визуальному дизайну, цветам и компонентам см. в [DESIGN_REQUIREMENTS.md](DESIGN_REQUIREMENTS.md).

---

## Общие правила навигации и доступа

| Условие | Поведение |
|--------|-----------|
| Пользователь не авторизован | Доступны: `/`, `/mentors`, `/mentors/:id`, `/login`, `/register`. Остальные маршруты → редирект на `/login` с сохранением `from` в state. |
| Авторизован, профиль не заполнен | Защищённые маршруты с `ProfileGuard` → редирект на `/onboarding`. |
| Авторизован, роль не выбрана | На `/profile` → редирект на `/onboarding`. |
| Загрузка профиля | Показывать полноэкранный индикатор «Загрузка...» (без перехода). |

Каталог `/mentors` и карточка ментора `/mentors/:id` доступны без авторизации (для знакомства с платформой).

---

## Роль: Менти (Mentee)

### 1. Первый вход (регистрация и онбординг)

| Шаг | Экран | URL | Триггер перехода | Элементы на экране |
|-----|--------|-----|------------------|--------------------|
| 1 | Гость на сайте | `/` или `/mentors` | Переход по ссылке / заход на сайт | Хедер: Логотип, ссылки «Менторы», «Войти», «Регистрация». Контент главной или каталог. |
| 2 | Регистрация | `/register` | Клик «Регистрация» | Форма: email, пароль, подтверждение пароля. Кнопка «Зарегистрироваться». Ссылка «Уже есть аккаунт? Войти». Валидация полей. |
| 3 | После успешной регистрации | — | Ответ API 201 | Редирект на `/onboarding` (или автоматический логин + редирект на онбординг по плану). |
| 4 | Выбор роли и профиль | `/onboarding` | Редирект от `ProfileGuard` или переход после регистрации | Выбор роли: «Менти» / «Ментор». После выбора «Менти» — форма: общие поля профиля + поля менти (цель/проблема, желаемая должность, статус поиска). Кнопка «Сохранить». |
| 5 | После сохранения профиля с ролью «Менти» | `/` | Успешное сохранение профиля | Редирект на главную. Дальше пользователь видит интерфейс менти. |

**Важно:** Если пользователь зашёл по защищённому маршруту без профиля, после логина его ведём на `state.from` или на `/onboarding`, если профиля нет.

---

### 2. Поиск ментора и избранное

| Шаг | Экран | URL | Триггер перехода | Элементы на экране |
|-----|--------|-----|------------------|--------------------|
| 1 | Каталог менторов | `/mentors` | Клик «Менторы» в навигации | Хедер с учётом роли (менти: «Менторы», «Избранное», «Мои заявки», «Связи», «Профиль», «Выйти»). Фильтры: специальность, теги, «Принимает заявки» (по умолчанию — да). Сетка карточек менторов. Пагинация. На карточке: имя, специальность, теги, статус приёма заявок, «В избранное», «Оставить заявку» (если принимает). |
| 2 | Карточка ментора | `/mentors/:id` | Клик по карточке или «Подробнее» | Фото/инициалы, имя, специальность, уровень, описание услуг, формат работы, теги, статус приёма заявок, комментарий к статусу (если не принимает), кол-во в избранном. Кнопки: «В избранное» / «В избранном», «Оставить заявку» (только если принимает заявки). Для гостя — «Оставить заявку» ведёт на логин. |
| 3 | Избранное | `/favorites` | Клик «Избранное» в навигации | Список менторов в избранном. Карточки с возможностью удалить из избранного и перейти к «Оставить заявку». Пустое состояние: «Пока никого нет. Перейти в каталог». |

**Видимость кнопок на карточке ментора (менити):**

- «В избранное» — всегда (для авторизованного менти). Иконка/состояние меняется: «В избранное» / «В избранном».
- «Оставить заявку» — только если у ментора `acceptsRequests === true`; иначе кнопка скрыта или неактивна с подсказкой.

---

### 3. Заявка на менторство

| Шаг | Экран | URL | Триггер перехода | Элементы на экране |
|-----|--------|-----|------------------|--------------------|
| 1 | Форма заявки | `/mentors/:id/request` | Клик «Оставить заявку» на карточке или странице ментора | Краткая сводка по ментору (имя, специальность). Поле «Сопроводительное письмо» (обязательное). Кнопки «Отправить» / «Отмена» (возврат на `/mentors/:id`). |
| 2 | После отправки | `/mentors/:id` или `/requests/outgoing` | Успешный ответ API | Toast: «Заявка отправлена». Редирект на страницу ментора или на «Мои заявки». |
| 3 | Мои заявки | `/requests/outgoing` | Клик «Мои заявки» в навигации | Список исходящих заявок: ментор, дата, статус (отправлена / принята / отклонена), текст письма. Для «принята» — ссылка на контакты или раздел «Связи». |

---

### 4. Связи и контакты

| Шаг | Экран | URL | Триггер перехода | Элементы на экране |
|-----|--------|-----|------------------|--------------------|
| 1 | Активные связи | `/connections` | Клик «Связи» в навигации | Список связей: ментор, дата начала. Контакты ментора (email или иное, что отдаёт API). Кнопка «Открепиться». |
| 2 | Открепление | Модальное окно или отдельная форма | Клик «Открепиться» | Причина (необязательное поле). Подтверждение. После успеха — связь переходит в «неактивные», контакты скрываются. Toast: «Вы откреплены». |

**Правило:** Контакты ментора видны менти только при статусе связи «активна» (заявка принята). После открепления контакты не показывать.

---

## Роль: Ментор (Mentor)

### 1. Первый вход (регистрация и онбординг)

| Шаг | Экран | URL | Триггер перехода | Элементы на экране |
|-----|--------|-----|------------------|--------------------|
| 1–3 | Как у менти | `/register` → логин → | — | То же. |
| 4 | Выбор роли и профиль | `/onboarding` | Редирект или после регистрации | Выбор «Ментор». Форма: общие поля + темы (теги), описание услуг, формат работы, принимает заявки (да/нет), комментарий к статусу (обязателен если не принимает), макс. кол-во активных менти. Кнопка «Сохранить». |
| 5 | После сохранения | `/` | Успешное сохранение | Редирект на главную. В навигации — пункты для ментора. |

---

### 2. Каталог (просмотр как гость/ментор)

| Шаг | Экран | URL | Триггер перехода | Элементы на экране |
|-----|--------|-----|------------------|--------------------|
| 1 | Каталог | `/mentors` | Клик «Менторы» | Ментор видит тот же каталог (для ориентира или поиска коллег). На карточках нет «В избранное» / «Оставить заявку» для своей карточки; для других — по бизнес-правилам (например, скрыть «Оставить заявку» для ментора). |

**Уточнение:** В MVP у пользователя одна роль. Ментор не отправляет заявки другим менторам; кнопки «В избранное» и «Оставить заявку» для роли «ментор» в каталоге можно не показывать или показывать только «Подробнее».

---

### 3. Входящие заявки

| Шаг | Экран | URL | Триггер перехода | Элементы на экране |
|-----|--------|-----|------------------|--------------------|
| 1 | Входящие заявки | `/requests/incoming` | Клик «Заявки» / «Входящие заявки» в навигации | Список заявок: менти (имя, цель/проблема из профиля), дата, текст письма. Кнопки «Принять» / «Отклонить». Индикация лимита: «Активных менти: X из Y». |
| 2 | Принять | — | Клик «Принять» | Подтверждение (модальное окно). После успеха: статус заявки «принята», создаётся связь, контакты менти открываются ментору. Toast: «Заявка принята». |
| 3 | Отклонить | — | Клик «Отклонить» | Подтверждение (опционально). Статус «отклонена». Toast: «Заявка отклонена». |

**Видимость кнопки «Принять»:** Скрыта или неактивна, если достигнут лимит активных менти (`maxMentees`).

---

### 4. Связи и открепление (ментор)

| Шаг | Экран | URL | Триггер перехода | Элементы на экране |
|-----|--------|-----|------------------|--------------------|
| 1 | Активные связи | `/connections` | Клик «Связи» в навигации | Список активных менти: имя, контакты, дата начала. Кнопка «Открепить». |
| 2 | Открепление | Модальное окно | Клик «Открепить» | Причина (необязательно). Подтверждение. После успеха — связь неактивна, контакты скрыты. Email-уведомление менти. |

---

## Сводная таблица маршрутов и прав

| URL | Гость | Менти | Ментор |
|-----|--------|-------|--------|
| `/` | Главная | Главная (после профиля) | Главная (после профиля) |
| `/login`, `/register` | Да | Редирект если авторизован | Редирект если авторизован |
| `/onboarding` | Нет (редирект на логин) | Да (если нет/неполный профиль) | Да (если нет/неполный профиль) |
| `/profile` | Нет | Да | Да |
| `/mentors` | Да | Да | Да |
| `/mentors/:id` | Да | Да | Да |
| `/mentors/:id/request` | Нет → логин | Да | Скрыто/не показывать |
| `/favorites` | Нет | Да | Не показывать в навигации |
| `/requests/outgoing` | Нет | Да | Не показывать |
| `/requests/incoming` | Нет | Не показывать | Да |
| `/connections` | Нет | Да | Да |
| `/admin/*` | Нет | Нет | Нет (только админ) |

---

## Триггеры и состояния элементов (кратко)

- **Кнопка «Оставить заявку»:** видна только менти и только если ментор принимает заявки; скрыта при лимите активных менти у ментора (на стороне бэкенда при принятии).
- **Кнопка «В избранное»:** только для авторизованного менти; переключение состояния «добавить» / «в избранном».
- **Контакты (ментор/менти):** отображаются только при активной связи; после открепления блок с контактами скрыть.
- **Навигация:** состав пунктов зависит от роли (менти: Менторы, Избранное, Мои заявки, Связи, Профиль; ментор: Менторы, Заявки, Связи, Профиль).
- **Профиль:** в настройках уведомлений — переключатель вкл/выкл email (Этап 8).
